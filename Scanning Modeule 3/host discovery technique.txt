- Host Discovery :

- Scanning is the process of gathering information about systems that are "alive" and responding on the network, and host discovery is the primary task to identify open ports and services.
- Host discovery is the first step in network scanning, using ping scan techniques to detect live hosts/systems.


- Host Discovery Techniques :

Host discovery techniques can be adopted to discover the active/live hosts in the network. As an ethical hacker, you must be aware of the various types of host discovery techniques. Some host discovery techniques are listed below:

  - ARP Ping Scan
  - UDP Ping Scan
  - ICMP Ping Scan
    - ICMP ECHO Ping
	- ICMP ECHO Ping Sweep
    - ICMP Timestamp PIng
    - ICMP Address Mask Ping 
  - TCP Ping Scan
    - TCP SYN Ping
    - TCP ACK Ping
  - IP Protocol Scan


- ARP Ping Scan :
 - The ARP ping scan is used to discover all active devices in the IPv4 range, even if they are hidden by firewalls.
 - To do this, the OS must determine the hardware destination address (ARP) corresponding to the target IP for addressing the ethernet frame correctly.
 - If the host IP with the respective hardware destination address is active, then the ARP response will be generated by the host; otherwise, after a certain number of ping attempts, the original OS gives up on the host.
 - In case the destination host is found to be unresponsive, the source host adds an incomplete entry to the destination IP in its kernel ARP table.


Attackers use the Nmap tool to perform ARP ping scan for discovering live hosts in the network. In Zenmap, the -PR option is used to perform ARP ping scan.

Note: -sn is the Nmap command to disable the port scan. Since Nmap uses ARP ping scan as the default ping scan, to disable it and perform other desired ping scans, you can use disable-arp-ping.


Advantages :
- ARP ping scan is considered to be more efficient and accurate than other host discovery techniques
- ARP ping scan automatically handles ARP requests, retransmission, and timeout at its own discretion
- ARP ping scan is useful for system discovery, where you may need to scan large address spaces
- ARP ping scan can display the response time or latency of a device to an ARP pack

- UDP Ping Scan :

- Nmap uses 40,125 as the default port number for UDP ping scan, which can be configured using DEFAULT_UDP_PROBE_PORT_SPEC during compile time.
- Attackers send UDP packets to the target host, and if it is offline or unreachable, error messages such as host/network unreachable or TTL exceeded can be returned. Zenmap uses the -PU option to perform a UDP ping scan.


Advantage : 
UDP ping scans have the advantage of detecting systems behind firewalls with strict TCP filtering, leaving the UDP traffic forgotten

ICMP ECHO Ping Scan

- Attackers use the ICMP ping scan to send ICMP packets to the destination system to gather all necessary information about it. This is because ICMP does not include port abstraction, and it is different from port scanning. However, it is useful to determine what hosts in a network are running by pinging them all.

- ICMP ECHO ping scan involves sending ICMP ECHO requests to a host. If the host is alive, it will return an ICMP ECHO reply. This scan is useful for locating active devices or determining if ICMP is passing through a firewall.

ICMP ECHO Ping Sweep

Ping sweeps are a basic network scanning technique used to determine the range of IP addresses that map to live hosts. ICMP echo scanning pings all the machines in the target network to discover live machines. Attackers send probes to the broadcast or network address, which relays to all the host addresses in the subnet.

Pings send a single packet to a specific IP address and wait for a return packet from the target system. They also detail the time taken for a packet to make a complete trip and help in resolving hostgames. Attackers calculate subnet masks and use ping sweep to create an inventory of live systems in the subnet.


ICMP Timestamp Ping Scan

Besides the traditional ICMP ECHO ping, there are some other types of ICMP pinging techniques such as ICMP timestamp ping scan and ICMP address mask ping scan, which an attacker can adopt in specific conditions.

ICMP timestamp ping is an optional and additional type of ICMP ping used to acquire information related to the current time from the target host machine. It is used for time synchronization and is effective in identifying whether the destination host machine is active. In Zenmap, the -PP option is used to perform an ICMP timestamp ping scan.



ICMP Address Mask Ping Scan

ICMP address mask ping is an alternative to the traditional ICMP ECHO ping, but is conditional and may not respond with the appropriate subnet value.

<image>

TCP SYN Ping Scan

TCP SYN ping is a host discovery technique for probing different ports to determine if the port is online and if it encounters any firewall rule sets. Port 80 is the default destination port.


Advantages :
- As the machines can be scanned parallelly, the scan never gets the time-out error while waiting for the response
- TCP SYN ping can be used to determin of the host is active without creating any connection. hence, the logs are not recorded at the system or network level, enabling the attacker to leave no traces for detection


TCP ACK Ping Scan

TCP ACK ping uses the default port 80 and sends an empty TCP ACK packet to the target host, which responds with an RST flag to terminate the request.


Advantages:

Both the SYN and the ACK packet can be used to maximize the chances of bypassing the firewall. However, firewalls are mostly configured to block the SYN ping packets, as they are the most common pinging technique. In such cases, the ACK probe can be effectively used to bypass these firewall rule sets easily.


IP Protocol Ping Scan :

- IP protocol ping is the latest host discovery option that sends IP ping packets with the IP header of any specified protocol number.
- It has the same format as the TCP and UDP ping.
Multiple IP packets for ICMP (protocol 1), IGMP (protocol 2), and IP-in-- IP (protocol 4) are sent by default when no protocols are specified


In a nutshell, attackers send different probe packets of different IP protocols to the target host; any response from any probe indicates that a host is online.

